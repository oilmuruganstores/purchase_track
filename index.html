<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Oil Murugan Stores | Purchase Tracker</title>

<style>
*{box-sizing:border-box}
html,body{
    margin:0;
    font-family:"Segoe UI",system-ui,sans-serif;
    background:linear-gradient(135deg,#eef2ff,#f8fafc);
    color:#0f172a;
}
:root{
    --blue:#2563eb;
    --green:#16a34a;
    --red:#dc2626;
    --orange:#f59e0b;
    --card:#ffffff;
    --muted:#64748b;
}

/* LAYOUT */
.app{
    max-width:1400px;
    margin:auto;
    padding:24px;
}

/* HEADER */
.header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:20px;
}
.header h1{
    margin:0;
    font-size:30px;
}
.badge{
    background:linear-gradient(135deg,#facc15,#f59e0b);
    padding:8px 16px;
    border-radius:999px;
    font-weight:700;
}

/* DASHBOARD */
.dashboard{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
    gap:16px;
    margin-bottom:25px;
}
.card{
    background:var(--card);
    padding:20px;
    border-radius:18px;
    box-shadow:0 12px 30px rgba(0,0,0,.08);
}
.card p{
    margin:0;
    color:var(--muted);
    font-size:14px;
}
.card h2{
    margin-top:10px;
    font-size:28px;
}
.blue{color:var(--blue)}
.green{color:var(--green)}
.red{color:var(--red)}
.orange{color:var(--orange)}

/* FILTERS */
.filters{
    background:var(--card);
    padding:18px;
    border-radius:18px;
    box-shadow:0 10px 25px rgba(0,0,0,.07);
    display:grid;
    grid-template-columns:1fr 180px 180px auto;
    gap:12px;
    margin-bottom:20px;
}
input,button,select{
    padding:12px;
    border-radius:12px;
    border:1px solid #e5e7eb;
    font-size:14px;
}
button{
    background:linear-gradient(135deg,var(--blue),#1d4ed8);
    color:#fff;
    border:none;
    font-weight:700;
    cursor:pointer;
}
.reset-btn{
    background:#e5e7eb;
    color:#111;
}

/* ENTRY FORM */
.form-box{
    background:var(--card);
    padding:20px;
    border-radius:18px;
    box-shadow:0 10px 25px rgba(0,0,0,.07);
    margin-bottom:20px;
}
.form-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
    gap:12px;
}

/* TABLE */
.table-box{
    background:var(--card);
    border-radius:18px;
    box-shadow:0 12px 30px rgba(0,0,0,.08);
    overflow:hidden;
}
table{
    width:100%;
    border-collapse:collapse;
}
th{
    background:linear-gradient(135deg,#1e293b,#334155);
    color:#fff;
    padding:15px;
    text-align:left;
}
td{
    padding:15px;
    border-bottom:1px solid #e5e7eb;
}
tbody tr:hover{
    background:#f1f5f9;
}
.edit{
    color:var(--blue);
    cursor:pointer;
    font-weight:600;
}
</style>
</head>

<body>
<div class="app">

<!-- HEADER -->
<div class="header">
    <h1>Oil Murugan Stores</h1>
    <div class="badge">Purchase Tracker</div>
</div>

<!-- DASHBOARD -->
<div class="dashboard">
    <div class="card">
        <p>Total Purchase</p>
        <h2 id="dBill" class="blue">â‚¹0</h2>
    </div>
    <div class="card">
        <p>Total Paid</p>
        <h2 id="dPaid" class="green">â‚¹0</h2>
    </div>
    <div class="card">
        <p>Paid by Cash</p>
        <h2 id="dCash" class="green">â‚¹0</h2>
    </div>
    <div class="card">
        <p>Paid by UPI</p>
        <h2 id="dUpi" class="green">â‚¹0</h2>
    </div>
    <div class="card">
        <p>Total Pending</p>
        <h2 id="dPending" class="red">â‚¹0</h2>
    </div>
</div>

<!-- FILTERS -->
<div class="filters">
    <input id="supplierFilter" placeholder="ðŸ” Supplier name">
    <input id="fromDate" type="date">
    <input id="toDate" type="date">
    <button class="reset-btn" onclick="resetFilters()">Reset</button>
</div>

<!-- ENTRY FORM -->
<div class="form-box">
<form id="form" class="form-grid">
    <input id="supplier" placeholder="Supplier Name" required>
    <input id="bill" type="number" placeholder="Bill Amount â‚¹" required>
    <input id="cash" type="number" placeholder="Cash Paid â‚¹" value="0">
    <input id="upi" type="number" placeholder="UPI Paid â‚¹" value="0">
    <input id="date" type="date" required>
    <button id="saveBtn">Add Purchase</button>
</form>
</div>

<!-- TABLE -->
<div class="table-box">
<table>
<thead>
<tr>
    <th>Supplier</th>
    <th>Date</th>
    <th>Bill</th>
    <th>Cash</th>
    <th>UPI</th>
    <th>Paid</th>
    <th>Pending</th>
    <th>Edit</th>
</tr>
</thead>
<tbody id="rows"></tbody>
</table>
</div>

</div>

<script>
let data = JSON.parse(localStorage.getItem("purchase_data")) || [];
let editIndex = null;

/* SAVE */
function save(){
    localStorage.setItem("purchase_data",JSON.stringify(data));
}

/* FILTER + RENDER */
function render(){
    rows.innerHTML="";
    let totalBill=0,totalPaid=0,totalCash=0,totalUpi=0;

    const sf = supplierFilter.value.toLowerCase();
    const fd = fromDate.value;
    const td = toDate.value;

    data.filter(e=>{
        if(sf && !e.supplier.toLowerCase().includes(sf)) return false;
        if(fd && e.date < fd) return false;
        if(td && e.date > td) return false;
        return true;
    }).forEach((e,i)=>{
        const paid = e.cash + e.upi;
        totalBill += e.bill;
        totalCash += e.cash;
        totalUpi += e.upi;
        totalPaid += paid;

        rows.innerHTML += `
        <tr>
            <td>${e.supplier}</td>
            <td>${e.date}</td>
            <td>${e.bill}</td>
            <td>${e.cash}</td>
            <td>${e.upi}</td>
            <td>${paid}</td>
            <td>${e.bill - paid}</td>
            <td class="edit" onclick="edit(${i})">Edit</td>
        </tr>`;
    });

    dBill.textContent = "â‚¹"+totalBill;
    dCash.textContent = "â‚¹"+totalCash;
    dUpi.textContent = "â‚¹"+totalUpi;
    dPaid.textContent = "â‚¹"+totalPaid;
    dPending.textContent = "â‚¹"+(totalBill-totalPaid);

    save();
}

/* ADD / UPDATE */
form.onsubmit = e=>{
    e.preventDefault();
    let entry={
        supplier:supplier.value.trim(),
        bill:+bill.value,
        cash:+cash.value,
        upi:+upi.value,
        date:date.value
    };

    if(entry.cash + entry.upi > entry.bill){
        alert("Paid amount cannot exceed bill amount");
        return;
    }

    if(editIndex!==null){
        data[editIndex]=entry;
        editIndex=null;
        saveBtn.textContent="Add Purchase";
    }else{
        data.push(entry);
    }

    form.reset();
    cash.value=upi.value=0;
    render();
};

/* EDIT */
function edit(i){
    let e=data[i];
    supplier.value=e.supplier;
    bill.value=e.bill;
    cash.value=e.cash;
    upi.value=e.upi;
    date.value=e.date;
    editIndex=i;
    saveBtn.textContent="Update Entry";
    window.scrollTo({top:0,behavior:"smooth"});
}

/* FILTER EVENTS */
supplierFilter.oninput=render;
fromDate.onchange=render;
toDate.onchange=render;

function resetFilters(){
    supplierFilter.value="";
    fromDate.value="";
    toDate.value="";
    render();
}

render();
</script>

</body>
</html>
